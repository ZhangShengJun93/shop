<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>    <title>分类编辑</title>    <link rel="stylesheet" type="text/css" href="/sysadm/css/base.css"><#include "../common/header.ftl"/>    <script type="text/javascript" src="/js/plugins/jquery.form.js"></script>    <script language="javascript">        $(function () {            //费用问题            $("#feebutton").click(function () {                $("#feeModal").modal("show");            });            $("#feeupdate").click(function () {                $("#feeFrom").ajaxSubmit(function (jsonResult) {                    if (jsonResult.success) {                        $.messager.confirm("温馨提示", "保存成功", function () {                            window.location.reload();                        })                    } else {                        $.messager.alert("温馨提示", "保存失败");                    }                });            });            //保证用户输入跟黏贴数据只能是数字            $("#sortOrder").keyup(function () {                var tmptxt = $(this).val();                $(this).val(tmptxt.replace(/[^\d]/g, ''));            }).bind("paste", function () {                var tmptxt = $(this).val();                $(this).val(tmptxt.replace(/[^\d]/g, ''));            }).css("ime-mode", "disabled");            $("#grade").keyup(function () {                var tmptxt = $(this).val();                $(this).val(tmptxt.replace(/[^\d]/g, ''));            }).bind("paste", function () {                var tmptxt = $(this).val();                $(this).val(tmptxt.replace(/[^\d]/g, ''));            }).css("ime-mode", "disabled");            $("#optionOne").text("顶级分类")        })        function formTijiao(tab) {            var orderId = $("#orderInfoId").val()            var desc = $("#orderDesc").val();            if (tab == 1) {                confirmTab = "您要确定订单吗？";            } else if (tab == 2) {                confirmTab = "您确定取消订单吗？";            } else if (tab == 3) {                confirmTab = "您确定把订单状态改成无效吗？";            } else if (tab == 4) {                confirmTab = "您确定把订单状态改成已付款吗？";            } else if (tab == 5) {                confirmTab = "您要确定发货吗？";            } else if (tab == 6) {                confirmTab = "您要确定配送吗？";            } else if (tab == 7) {                if ($.trim(desc).length == 0) {                    alert("售后操作备注不能为空！")                    return;                }                window.location.href = "/changeOrderStatus?orderId=" + orderId + "&status=" + tab + "&orderDesc=" + desc;                return;            }            if (confirm(confirmTab)) {                if ($.trim(desc).length > 0) {                    desc = encodeURI(desc);                }                window.location.href = "/changeOrderStatus?orderId=" + orderId + "&status=" + tab + "&orderDesc=" + desc;            }        }        function toEditUI(tab) {            var orderId = $("#orderInfoId").val()            if (tab == "ohter") {                window.location.href = "/sysadm/order/toEditOrderOhterInfoUI.do?orderId=" + orderId;            } else if (tab == "consignee") {                window.location.href = "/updateUserInfo?orderId=" + orderId;            } else if (tab == "shipping") {                window.location.href = "/sysadm/order/toEditShippingInfoUI.do?orderId=" + orderId;            } else if (tab == "pay") {                window.location.href = "/sysadm/order/toEditPayInfoUI.do?orderId=" + orderId;            } else if (tab == "goods") {                window.location.href = "/sysadm/order/toEditGoodsInfoUI.do?orderId=" + orderId;            } else if (tab == "fee") {                window.location.href = "/sysadm/order/toEditFeeInfoUI.do?orderId=" + orderId;            }        }    </script></head><body leftmargin="8" topmargin="8" background='/sysadm/images/allbg.gif'><!--  内容列表   --><table width="98%" border="0" cellpadding="2" cellspacing="1" bgcolor="#D1DDAA" align="center" style="margin-top:8px">    <tr bgcolor="#E7E7E7">        <td height="30" background="/sysadm/images/tbg.gif" colspan="7">&nbsp;            订单信息            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="返回" onclick="window.location.href='/orderInfo' "/>        </td>    </tr></table><table width='98%' align="center" style="margin-top:8px">    <tr bgcolor='#EEF4EA'>        <td background='/sysadm/images/wbg.gif' align='center' height="30px">            基本信息        </td>    </tr></table><table width="98%">    <tr>        <td align="right" height="25px"><strong>订单号：</strong></td>        <td align="left">${orderInfo.id}</td>        <td align="right"><strong>订单状态：</strong></td>        <td align="left">            未确认,            已付款,            未发货        </td>    </tr>    <tr>        <td align="right" height="25px"><strong>购货人：</strong></td>        <td align="left">${orderInfo.consignee}<!-- <a href="#">[ 显示购货人信息 ] </a><a href="#">[ 发送/查看留言 ]</a> --></td>        <td align="right"><strong>下单时间：</strong></td>        <td align="left">            <script type="text/javascript">                var newTime = new Date(1495355002988);                var momth = newTime.getMonth() + 1;                document.write(newTime.getFullYear() + "-" + momth + "-" + newTime.getDate() + " " + newTime.getHours() + ":" + newTime.getMinutes() + ":" + newTime.getSeconds());            </script>        </td>    </tr>    <tr>        <td align="right" height="25px"><strong>支付方式：</strong></td>        <td align="left">积分支付&nbsp;<input type="button" value="编辑" style="height: 20px;cursor: pointer;display: none;"                                          onclick="toEditUI('pay')"/></td>        <td align="right"><strong>付款时间：</strong></td>        <td align="left">            <script type="text/javascript">                var newTime = new Date(1495355003010);                var momth = newTime.getMonth() + 1;                document.write(newTime.getFullYear() + "-" + momth + "-" + newTime.getDate() + " " + newTime.getHours() + ":" + newTime.getMinutes() + ":" + newTime.getSeconds());            </script>        </td>    </tr>    <tr>        <td align="right" height="25px"><strong>配送方式：</strong></td>        <td align="left">默认快递&nbsp;<input type="button" value="编辑" style="height: 20px;cursor: pointer; display: none;"                                          onclick="toEditUI('shipping')"/></td>        <td align="right"><strong>发货时间：</strong></td>        <td align="left">            暂无        </td>    </tr>    <tr>        <td align="right" height="25px"><strong>发货单号：</strong></td>        <td align="left">暂无</td>        <td align="right"><strong>订单来源：</strong></td>        <td align="left">            本站        </td>    </tr>    <tr bgcolor='#EEF4EA' border='0' cellpadding='1' cellspacing='1'>        <td background='/sysadm/images/wbg.gif' align='center' height="30px" colspan="4">            收货人信息&nbsp;<input type="button" value="编辑" style="cursor: pointer;" onclick="toEditUI('consignee')"/>        </td>    </tr>    <tr>        <td height="25px" align="right"><strong>收货人：</strong></td>        <td height="25px" align="left">${orderInfo.user.username}</td>        <td height="25px" align="right"><strong>电子邮件：</strong></td>        <td height="25px" align="left">${orderInfo.user.email}</td>    </tr>    <tr>        <td height="25px" align="right"><strong>地址：</strong></td>        <td height="25px" align="left">${orderInfo.address}</td>        <td height="25px" align="right"><strong>邮编：</strong></td>        <td height="25px" align="left">${orderInfo.zipcode}</td>    </tr>    <tr>        <td height="25px" align="right"><strong>电话：</strong></td>        <td height="25px" align="left">${orderInfo.mobile}</td>        <td height="25px" align="right"><strong>手机：</strong></td>        <td height="25px" align="left">${orderInfo.user.phone}</td>    </tr>    <tr>        <td height="25px" align="right"><strong>标志性建筑：</strong></td>        <td height="25px" align="left">暂无</td>        <td height="25px" align="right"><strong>最佳送货时间：</strong></td>        <td height="25px" align="left">暂无</td>    </tr></table><table width="98%">    <tr bgcolor='#EEF4EA' border='0' cellpadding='1' cellspacing='1'>        <td background='/sysadm/images/wbg.gif' align='center' height="30px" colspan="7">            商品信息&nbsp;        </td>    </tr>    <tr>        <td height="25px" align="center"><strong>商品名称 </strong></td>        <td height="25px" align="center"><strong>货号 </strong></td>        <td height="25px" align="center"><strong>价格</strong></td>        <td height="25px" align="center"><strong>数量</strong></td>        <td height="25px" align="center"><strong>属性</strong></td>        <td height="25px" align="center"><strong>库存</strong></td>        <td height="25px" align="center"><strong>小计</strong></td>    </tr>    <tr>        <td height="25px" align="center"><a href="/goods/6004.html" target="_blank">${orderProduct.productName}</a></td>        <td align="center">${orderProduct.code}</td>        <td align="center">${orderProduct.productPrice}</td>        <td align="center">${orderProduct.productNumber}</td>        <td align="center">${orderProduct.skuAttr}</td>        <td align="center">1</td>        <td align="center">￥            <script type="text/javascript">                document.write(parseFloat(${orderProduct.productPrice} *${orderProduct.productNumber}).toFixed(2)                )            </script>            <input type="hidden" name="totalPrice" value="95.0"/></td>    </tr>    <tr>        <td height="25px" align="center"></td>        <td height="25px" align="center"></td>        <td height="25px" align="center"></td>    </tr></table><table width="98%">    <tr bgcolor='#EEF4EA' border='0' cellpadding='1' cellspacing='1'>        <td background='/sysadm/images/wbg.gif' align='center' height="30px">            费用信息&nbsp;<input type="button" value="编辑" style="cursor: pointer;" id="feebutton"/>        </td>    </tr>    <tr>        <td align="right">            商品总金额：￥${orderInfo.orderProductPrice.productPrice}元 - 折扣：￥${orderInfo.orderProductPrice.discount}元 +            发票税额：￥${orderInfo.orderProductPrice.invoice}            + 配送费用：￥${orderInfo.orderProductPrice.delivery}元 + 保价费用：￥0.0元 +            支付费用：￥${orderInfo.orderProductPrice.paidPrice}元            + 包装费用：￥${orderInfo.orderProductPrice.protect}元 + 贺卡费用：￥${orderInfo.orderProductPrice.cardPrice}元        </td>    </tr>    <tr>        <td align="right">            = 订单总金额：￥${orderInfo.orderProductPrice.totalAmout}元        </td>    </tr>    <tr>        <td align="right">            - 已付款金额：￥${orderInfo.orderProductPrice.paidPrice}元        </td>    </tr>    <tr>        <td align="right">            = 应付款金额：￥${orderInfo.orderProductPrice.handlePrice}元        </td>    </tr></table><table width="98%">    <tr bgcolor='#EEF4EA' border='0' cellpadding='1' cellspacing='1'>        <td background='/sysadm/images/wbg.gif' align='center' height="30px" colspan="7">            操作信息        </td>    </tr>    <tr>        <td align="right">            <strong>操作备注：</strong>        </td>        <td>            <textarea rows="2" cols="70" id="orderDesc"></textarea>        </td>    </tr>    <tr>        <td align="right">            <strong>当前可执行操作： </strong>        </td>        <td height="35px">            <input type="button" value="${orderInfo.orderStatusDis}" style="width: 80px;" onclick="formTijiao(1)"/>&nbsp;&nbsp;        </td>    </tr></table><input type="hidden" id="orderInfoId" value="${orderInfo.id}"/><table width="98%">    <tr bgcolor='#EEF4EA' border='0' cellpadding='1' cellspacing='1'>        <td background='/sysadm/images/wbg.gif' align='center' height="30px" colspan="6">            操作记录        </td>    </tr>    <tr>        <td height="25px" align="center"><strong>操作者</strong></td>        <td height="25px" align="center"><strong>操作时间 </strong></td>        <td height="25px" align="center"><strong>订单状态</strong></td>        <td height="25px" align="center"><strong>付款状态</strong></td>        <td height="25px" align="center"><strong>发货状态</strong></td>        <td height="25px" align="center"><strong>备注</strong></td>    </tr><#if (orderActions?size>0)>    <#list orderActions as orderAction>        <tr>            <td align="center">                ${(orderAction.actionUser)!""}            </td>            <td align="center">                ${(orderAction.actionTime?string("yyyy-MM-dd"))!""}            </td>            <td align="center">                ${(orderAction.orderStatusDis)!""}            </td>            <td align="center">                ${(orderAction.payStatusDis)!""}            </td>            <td align="center">                ${(orderAction.shippingStatusDis)!""}            </td>            <td align="center">                ${(orderAction.actionNote)!""}            </td>        </tr>    </#list></#if></table></body><div class="modal fade" tabindex="-1" role="dialog" id="feeModal">    <div class="modal-dialog" role="document">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal" aria-label="Close">                    <span aria-hidden="true">&times;</span>                </button>                <h4 class="modal-title">费用信息</h4>            </div>            <div class="modal-body">                <form action="/feeSubmit" method="post" id="feeFrom">                    <table>                        <thead>                        <input type="hidden" name="id" value="${orderInfo.id}"/>                        <input type="hidden" name="orderId" value="${opp.id}"/>                        </thead>                        <tbody>                        <tr>                            <td>商品费用:</td>                            <td>                                <div class="input-group">                                    <input type="text" name="productPrice" value="${opp.productPrice?c}"/>                                </div>                            </td>                            <td>折扣:</td>                            <td>                                <div class="input-group">                                    <input type="text" name="discount" value="${opp.discount?c}"/>                                </div>                            </td>                        </tr>                        <tr>                            <td>配送费:</td>                            <td>                                <div class="input-group">                                    <input type="text" name="delivery" value="${opp.delivery?c}"/>                                </div>                            </td>                            <td>保护费用:</td>                            <td>                                <div class="input-group">                                    <input type="text" name="protect" value="${opp.protect?c}"/>                                </div>                            </td>                        </tr>                        <tr>                            <td>发票:</td>                            <td>                                <div class="input-group">                                    <input type="text" name="invoice" value="${opp.invoice?c}"/>                                </div>                            </td>                            <td>卡片费用:</td>                            <td>                                <div class="input-group">                                    <input type="text" name="cardPrice" value="${opp.cardPrice?c}"/>                                </div>                            </td>                        </tr>                        </tbody>                    </table>                </form>            </div>            <div class="modal-footer">                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>                <button type="button" class="btn btn-primary" id="feeupdate">确定</button>            </div>        </div>    </div></div></html>